<!doctype>
<html ng-app='sleth'>
<head>
    <title>sleth - Ethereum Slots</title>
    <script type="text/javascript" src="lib/angular.min.js"></script>
    <script type="text/javascript" src="lib/promise.min.js"></script>
    <script type="text/javascript" src="lib/bignumber.min.js"></script>
    <script type="text/javascript" src="lib/ethereum.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootswatch/3.3.2/flatly/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/slots.css" />
</head>
<body ng-controller="SlethController" ng-keypress="handleKey($event)">

<div class="container">

<div class="row player-bar">
    <div class="col-sm-3">
        Player <span class="label label-default">{{player.address | limitTo : 10}}</span>
    </div>
    <div class="col-sm-3 text-center">
        Balance <span class="label label-default">{{player.balance | number : 4}} ETH</span>
    </div>
    <div class="col-sm-3 text-center">
        Block <span class="label label-default">{{blockNumber}}</span>
    </div>
    <div class="col-sm-3 text-right">
        Network
        <span ng-switch on="web3Available">
            <span ng-switch-when="true" class="label label-success">online</span>
            <span ng-switch-when="false" class="label label-danger">offline</span>
        </span>
    </div>
</div>

<div class="alert alert-danger top-buffer" role="alert" ng-if="web3Error">
    <strong>{{web3Error.name}}</strong> {{web3Error.message}}
</div>

<div class="row">
    <div class="col-md-8 text-center">
        <div id="game" ng-style="{'width': canvasSize}">
            <canvas slots-reels id="slots" width="{{canvasSize}}" height="{{canvasSize}}"></canvas>
        </div>
    </div>
    <div class="col-md-4">
        <div id="info">
            <h1 id="credits">Coins ({{player.coins}})</h1>
            <p id="log" class="lead">
                <span ng-if="reward.payout">
                    You won {{reward.payout}}!<br />
                </span>
                <span ng-repeat="(line, partial_payout) in reward.partial_payouts">
                    Line {{line}} pays {{partial_payout}}<br />
                </span>
            </p>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8 text-center">
        <button type="button" class="btn btn-info" ng-click="spin(1)" ng-disabled="player.coins < 1 || spinning">1 Line</button>
        <button type="button" class="btn btn-info" ng-click="spin(3)" ng-disabled="player.coins < 3 || spinning">3 Lines</button>
        <button type="button" class="btn btn-info" ng-click="spin(5)" ng-disabled="player.coins < 5 || spinning">5 Lines</button>
    </div>
    <div class="col-md-4">
        <p><a class="btn btn-success" href="paytable.html" target="_blank" role="button">Pay Table</a></p>
    </div>
</div>

<div class="row top-buffer">
    <div class="col-md-8">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">Last Round #{{round.number}}</h3>
            </div>
            <table class="table table-condensed">
                <tr><th>Player</th><td>{{round.player | limitTo : 10}}</td></tr>
                <tr><th>Block</th><td>{{round.block}}</td></tr>
                <tr><th>Timestamp</th><td>{{round.timestamp | date : 'medium'}}</td></tr>
                <tr><th>Bet</th><td>{{round.bet}}</td></tr>
                <tr ng-if="round.status == 2"><th>Result</th><td>{{round.result}}</td></tr>
                <tr ng-if="round.status == 2"><th>Entropy</th><td>{{round.entropy | limitTo : 10}}</td></tr>
                <tr ng-if="round.status == 2"><th>RND</th><td>{{round.rnd}}</td></tr>
                <tr><th>Status:
                    <td ng-switch on="round.status">
                        <span ng-switch-when="0">NEW</span>
                        <span ng-switch-when="1">SPINNING</span>
                        <span ng-switch-when="2">DONE</span>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <div class="col-md-4">
        <div class="panel panel-warning">
            <div class="panel-heading">
                <h3 class="panel-title">Stats</h3>
            </div>
            <table class="table table-condensed">
                <tr><th>Contract</th><td>{{slethAddress | limitTo : 10}}</td></tr>
                <tr><th>Contract Balance</th><td>{{slethBalance | number : 4}} ETH</td></tr>
                <tr><th>Total Spins</th><td>{{stats.total_spins}}</td></tr>
                <tr><th>Total Coins Won</th><td>{{stats.total_coins_won}}</td></tr>
            </table>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Messages</h3>
            </div>
            <ul class="list-group">
                <li class="list-group-item" ng-repeat="message in messages track by $index">
                    {{message}}
                </li>
            </ul>
        </div>
    </div>
</div>

</div>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="game.js"></script>
<script type="text/javascript" src="reels.js"></script>
<script type="text/javascript" src="sleth.js"></script>
</body>
</html>
